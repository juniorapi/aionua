var check_lvl=function(a){$('#left_stigma section[id *= "wrap_"]').css({opacity:1}).find("div").attr("data-status","enabled"),$('#right_stigma div[class *= "gold"], div[class *= "blue"], div[class *= "green"]').removeClass("disable_stigma"),$('#stigma_info td[class *= "gold"], #stigma_info td[class *= "blue"], #stigma_info td[class *= "hidden"]').removeClass("disable_stigma").removeAttr("data-status"),55>a&&($('#right_stigma div[class *= "gold"]').addClass("disable_stigma"),$('#stigma_info td[class *= "gold"],#stigma_info td[class *= "hidden"]').addClass("disable_stigma").attr("data-status","disabled"),$("#left_stigma #wrap_gold1").css({opacity:0}).find("div").attr("data-status","disabled")),45>a&&($('#right_stigma div[class *= "blue"]').addClass("disable_stigma"),$('#stigma_info td[class *= "blue"]').addClass("disable_stigma"),$("#left_stigma #wrap_blue1, #wrap_blue2").css({opacity:0}).find("div").attr("data-status","disabled")),50>a&&$("#left_stigma #wrap_blue1").css({opacity:0}).find("div").attr("data-status","disabled"),40>a&&$("#left_stigma #wrap_green1").css({opacity:0}).find("div").attr("data-status","disabled"),30>a&&$("#left_stigma #wrap_green2").css({opacity:0}).find("div").attr("data-status","disabled")},selection_stigmas=function(a){var l=$(a).attr("data-stigma"),s=$(a).attr("data-level"),t=$(a).attr("class"),e=$('#right_stigma div[data-stigma = "'+l+'"]'),i=$('#stigma_info td[data-stigma = "'+e.attr("data-stigma")+'"]');e.hasClass("disable_stigma")||(i.addClass("disable_stigma").attr("data-status","disabled"),e.css({display:"none"}),$('#left_stigma div[data-stigma = "00"][data-status != "disabled"][data-level *= "'+s+'"]:last').attr("data-stigma",l).attr("class","list "+t).parent().addClass("current"))},getVisionStigma=function(a){var l={templar:{"001":["02","04","05"],"002":["01","03","08"]},gladiator:{"001":["02","03","05"],"002":["01","04","06"]},ranger:{"001":["01","04","05"],"002":["02","03","06"]},assassin:{"001":["01","07","05"],"002":["02","08","06"]},sorcerer:{"001":["01","03","04"],"002":["02","08","06"]},spiritmaster:{"001":["01","04","03"],"002":["02","08","07"]},chanter:{"001":["01","05","06"],"002":["02","08","04"]},cleric:{"001":["02","06","04"],"002":["01","03","07"]},gunner:{"001":["01","04","07"],"002":["02","03","06"]},aethertech:{"001":["02","07","08"],"002":["01","05","03"]},songweaver:{"001":["01","04","05"],"002":["02","03","06"]}};if("001"==a||"002"==a){if(!$('#right_stigma td[data-stigma = "'+a+'"]').hasClass("disable_stigma")){clear_build();var s=$('#right_stigma div[data-stigma = "'+l[charater][a][0]+'"]'),t=$('#right_stigma div[data-stigma = "'+l[charater][a][1]+'"]'),e=$('#right_stigma div[data-stigma = "'+l[charater][a][2]+'"]');selection_stigmas(s),selection_stigmas(t),selection_stigmas(e)}}else selection_stigmas($('#right_stigma div[data-stigma = "'+a+'"]'))},removing_stigmas=function(a){var l=$(a).attr("data-stigma");$('#right_stigma div[data-stigma = "'+l+'"]:hidden').css({display:"inline-block"}),$('#stigma_info td[data-stigma *= "'+l+'"]').removeAttr("data-status"),$(a).attr("data-stigma","00").attr("class","list").parent().removeClass("current"),enchant[1*l-1]=0},check_stigmas=function(){var a=$('#left_stigma div[data-level *= "321"][data-stigma = "00"][data-status = "enabled"]').size(),l=$('#left_stigma div[data-level *= "21"][data-stigma = "00"][data-status = "enabled"]').size(),s=$('#left_stigma div[data-level *= "1"][data-stigma = "00"][data-status = "enabled"]').size(),t="disable_stigma";a?($('#right_stigma div[data-level = "321"]:visible').removeClass(t),$('#stigma_info td[data-level = "321"][data-status != "disabled"]').removeClass(t)):($('#right_stigma div[data-level = "321"]:visible').addClass(t),$('#stigma_info td[data-level = "321"]').addClass(t)),l?($('#right_stigma div[data-level = "21"]:visible').removeClass(t),$('#stigma_info td[data-level = "21"][data-status != "disabled"]').removeClass(t)):($('#right_stigma div[data-level = "21"]:visible').addClass(t),$('#stigma_info td[data-level = "21"]').addClass(t)),s?$('#right_stigma div[data-level = "1"]:visible').removeClass(t):$('#right_stigma div[data-level = "1"]:visible').addClass(t)},clear_build=function(){$("#left_stigma div[data-level]").attr("data-stigma","00").attr("class","list").parent().removeClass("current"),$('#right_stigma div[class *= "stigma"]').css("display","inline-block").removeClass("disable_stigma"),$("#stigma_info td[data-stigma]").removeAttr("data-status"),enchant=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],hidden_stigma()},hidden_stigma=function(){if(0==$('#left_stigma div[data-stigma = "00"]').size()){var a=[];$('#left_stigma div[data-stigma != "00"][data-level *= "21"]').each(function(){a.push($(this).attr("data-stigma"))}),a.sort(),a=String(a);var l={templar:{hidden_1:{build:["02,04,05","02,04,07","02,05,07"],stigma:"001"},hidden_2:{build:["01,03,08","01,03,06","01,06,08"],stigma:"002"},hidden_3:{stigma:"003"}},gladiator:{hidden_1:{build:["02,03,05","02,03,08","02,05,08"],stigma:"001"},hidden_2:{build:["01,04,06","01,04,07","01,06,07"],stigma:"002"},hidden_3:{stigma:"003"}},ranger:{hidden_1:{build:["01,04,05","01,04,08","01,05,08"],stigma:"001"},hidden_2:{build:["02,03,06","02,03,07","02,06,07"],stigma:"002"},hidden_3:{stigma:"003"}},assassin:{hidden_1:{build:["01,05,07","01,04,05","01,04,07"],stigma:"001"},hidden_2:{build:["02,06,08","02,03,08","02,03,06"],stigma:"002"},hidden_3:{stigma:"003"}},sorcerer:{hidden_1:{build:["01,03,04","01,03,05","01,04,05"],stigma:"001"},hidden_2:{build:["02,06,08","02,07,08","02,06,07"],stigma:"002"},hidden_3:{stigma:"003"}},spiritmaster:{hidden_1:{build:["01,03,04","01,04,05","01,03,05"],stigma:"001"},hidden_2:{build:["02,07,08","02,06,08","02,06,07"],stigma:"002"},hidden_3:{stigma:"003"}},chanter:{hidden_1:{build:["01,05,06","01,05,07","01,06,07"],stigma:"001"},hidden_2:{build:["02,04,08","02,03,08","02,03,04"],stigma:"002"},hidden_3:{stigma:"003"}},cleric:{hidden_1:{build:["02,04,06","02,05,06","02,04,05"],stigma:"001"},hidden_2:{build:["01,03,07","01,03,08","01,07,08"],stigma:"002"},hidden_3:{stigma:"003"}},gunner:{hidden_1:{build:["01,04,07","01,04,05","01,05,07"],stigma:"001"},hidden_2:{build:["02,03,06","02,03,08","02,06,08"],stigma:"002"},hidden_3:{stigma:"003"}},aethertech:{hidden_1:{build:["02,07,08","02,06,07","02,06,08"],stigma:"001"},hidden_2:{build:["01,03,05","01,04,05","01,03,04"],stigma:"002"},hidden_3:{stigma:"003"}},songweaver:{hidden_1:{build:["01,04,05","01,04,07","01,05,07"],stigma:"001"},hidden_2:{build:["02,03,06","02,03,08","02,06,08"],stigma:"002"},hidden_3:{stigma:"003"}}},s=100;$('#left_stigma div[data-level *= "1"]').each(function(){var a=$(this).attr("data-stigma");enchant[1*a-1]<s&&(s=enchant[1*a-1])}),enchant[17]=s,enchant[18]=s,enchant[19]=s,enchant[20]=s;var t=$("#left_stigma #hidden_stigma");$.each(l,function(l,s){l==charater&&(s.hidden_1.build[0]==a||s.hidden_1.build[1]==a||s.hidden_1.build[2]==a?t.addClass("hidden"+1*s.hidden_1.stigma).attr("data-stigma",s.hidden_1.stigma):s.hidden_2.build[0]==a||s.hidden_2.build[1]==a||s.hidden_2.build[2]==a?t.addClass("hidden"+1*s.hidden_2.stigma).attr("data-stigma",s.hidden_2.stigma):t.addClass("hidden3").attr("data-stigma",s.hidden_3.stigma))}),$("#left_stigma").attr("class","left_stigma_bg2")}else $("#left_stigma #hidden_stigma").attr("class","list").attr("data-stigma","000"),$("#left_stigma").attr("class","left_stigma_bg1")},tooltip=function(a){var l=$(document).scrollTop(),s=window.innerHeight,t=window.innerWidth,e=(t-$(window).width())/2,i=10,g=mouseY+a.height()+30,d=mouseX+a.width()+65,p=g>s+l?mouseY-i+20+s+l-g:mouseY-i+20,v=d>t?mouseX-e-a.width()-40:mouseX-e+40;a.css({top:p,left:v})},clearEnchant=function(){enchant=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},hashReplace={"intReplaсe":{l:"01",j:"02",a:"03",g:"04",i:"05",b:"06",c:"07",o:"08",d:"09",f:"10",h:"11",n:"12",e:"13",m:"14",k:"15",p:"16",q:"17",z:"00"},litReplace:{"01":"l","02":"j","03":"a","04":"g","05":"i","06":"b","07":"c","08":"o","09":"d",10:"f",11:"h",12:"n",13:"e",14:"m",15:"k",16:"p",17:"q","00":"z"},intEnchantReplace:{w:1,t:2,s:3,x:4,v:5,u:6,q:7,n:8,r:9,y:10,z:0},litEnchantReplace:{1:"w",2:"t",3:"s",4:"x",5:"v",6:"u",7:"q",8:"n",9:"r",10:"y",0:"z"}},getBuild=function(){for(var a=0,l=0;l<=enchant.length;l++)enchant[l]>a&&(a=enchant[l]);var s={},t=$("#gold1").attr("data-stigma"),e=$("#blue1").attr("data-stigma"),i=$("#blue2").attr("data-stigma"),g=$("#green1").attr("data-stigma"),d=$("#green2").attr("data-stigma"),p=$("#green3").attr("data-stigma");return s.stigmas=hashReplace.litReplace[t]+hashReplace.litReplace[e]+hashReplace.litReplace[i]+hashReplace.litReplace[g]+hashReplace.litReplace[d]+hashReplace.litReplace[p],s.enchant="",a&&(s.enchant=hashReplace.litEnchantReplace["00"!=t?enchant[t-1]:0]+hashReplace.litEnchantReplace["00"!=e?enchant[e-1]:0]+hashReplace.litEnchantReplace["00"!=i?enchant[i-1]:0]+hashReplace.litEnchantReplace["00"!=g?enchant[g-1]:0]+hashReplace.litEnchantReplace["00"!=d?enchant[d-1]:0]+hashReplace.litEnchantReplace["00"!=p?enchant[p-1]:0]),s.lvl=":"+$("#char_lvl").val(),location.hash=s.stigmas+s.enchant+s.lvl,location.protocol+"//"+location.hostname+location.pathname+"#"+s.stigmas+s.enchant+s.lvl},checkLang=function(a){return"ru"==a?location.href=location.protocol+"//"+location.hostname+"/"+charater+location.hash:location.href=location.protocol+"//"+location.hostname+"/en/"+charater+location.hash},parseBuild=function(){var a=location.hash.slice(1);if(""!==a){clear_build(),clearEnchant();var l=a.slice(1,2);if(isNaN(l)){var s=hashReplace.intReplaсe[a.slice(0,1)],t=hashReplace.intReplaсe[a.slice(1,2)],e=hashReplace.intReplaсe[a.slice(2,3)],i=hashReplace.intReplaсe[a.slice(3,4)],g=hashReplace.intReplaсe[a.slice(4,5)],d=hashReplace.intReplaсe[a.slice(5,6)];selection_stigmas($('#right_stigma div[data-stigma = "'+d+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+g+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+i+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+e+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+t+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+s+'"]')),""!==a.slice(6,7)&&":"!==a.slice(6,7)&&(enchant[1*s-1]=hashReplace.intEnchantReplace[a.slice(6,7)],enchant[1*t-1]=hashReplace.intEnchantReplace[a.slice(7,8)],enchant[1*e-1]=hashReplace.intEnchantReplace[a.slice(8,9)],enchant[1*i-1]=hashReplace.intEnchantReplace[a.slice(9,10)],enchant[1*g-1]=hashReplace.intEnchantReplace[a.slice(10,11)],enchant[1*d-1]=hashReplace.intEnchantReplace[a.slice(11,12)]),":"==a.slice(-3,-2)&&$("#char_lvl").val(a.slice(-2))}else{var s=a.slice(1,3),t=a.slice(5,7),e=a.slice(9,11),i=a.slice(13,15),g=a.slice(17,19),d=a.slice(21,23);selection_stigmas($('#right_stigma div[data-stigma = "'+d+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+g+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+i+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+e+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+t+'"]')),selection_stigmas($('#right_stigma div[data-stigma = "'+s+'"]'))}check_stigmas(),hidden_stigma(),check_lvl($("#char_lvl").val())}},getSkill=function(a,l,s){var t,a=1*a-1,e=$("#char_lvl").val(),i={};s++;var g=' <img src="/stigmas/img/lvlup.png" class="lvlup" alt="">',d={self:"Self",target:"Selected Target",selfortarget:"Self / Selected Target",around:"Area around caster",point:"Specified Location",party:"Group Member",zone:"Area within a Radius of Target",summon:"Pet",partywithpet:"Pet"};if("321"==l||"hidden"==l)if(e>=55){if(t=(e-55)/4+1,t-=t%1,!skill[a].lvls instanceof Array&&void 0==skill[a].lvls["lvl_"+t]){t=0;for(var p in skill[a].lvls)t++}void 0==skill[a].lvls[t]&&skill[a].lvls instanceof Array&&(t=skill[a].lvls.length),i.lvl=55+4*t-4,i.lvl_status=!0}else t=1,i.lvl=55,i.lvl_status=!1;else if("21"==l)if(e>=45){if(t=(e-45)/4+1,t-=t%1,!skill[a].lvls instanceof Array&&void 0==skill[a].lvls["lvl_"+t]){t=0;for(var p in skill[a].lvls)t++}void 0==skill[a].lvls[t]&&skill[a].lvls instanceof Array&&(t=skill[a].lvls.length),i.lvl=45+4*t-4,i.lvl_status=!0}else t=1,i.lvl=45,i.lvl_status=!1;else if("1"==l)if(e>=20)if(1*skill[a].lvl>8){if(t=(e-20)/5+1,t-=t%1,!skill[a].lvls instanceof Array&&void 0==skill[a].lvls["lvl_"+t]){t=0;for(var p in skill[a].lvls)t++}void 0==skill[a].lvls[t]&&skill[a].lvls instanceof Array&&(t=skill[a].lvls.length),i.lvl=20+5*t-5,i.lvl_status=!0}else{if(t=(e-20)/6+1,t-=t%1,!skill[a].lvls instanceof Array&&void 0==skill[a].lvls["lvl_"+t]){t=0;for(var p in skill[a].lvls)t++}void 0==skill[a].lvls[t]&&skill[a].lvls instanceof Array&&(t=skill[a].lvls.length),i.lvl=20+6*t-6,i.lvl_status=!0}else t=1,i.lvl=20,i.lvl_status=!1;t-=1,i.name=skill[a].name_l10n,i.tag=skill[a].skill_tag,i.type=skill[a].skill_type,i.sub_type=skill[a].skill_sub_type,i.condition=skill[a].condition.split(";");for(var v=[],r=0;r<=i.condition.length;r++)switch(i.condition[r]){case"sword":v.push("Sword");break;case"mace":v.push("Mace");break;case"dagger":v.push("Dagger");break;case"2hsword":v.push("Greatsword");break;case"polearm":v.push("Polearm");break;case"harp":v.push("Harp");break;case"bow":v.push("Bow");break;case"orb":v.push("Orb");break;case"book":v.push("Spellbook");break;case"gun":v.push("Pistol");break;case"cannon":v.push("Aether Cannon");break;case"keyblade":v.push("Cipher-Blade");break;case"shield":v.push("Shield");break;case"ride_robot":v.push("Available when riding a Bastion");break;case"melee":v.push("Melee Weapon")}switch(v=v.length?'<hr><div class="condition">Usage Requirement: '+v.join("/")+".</div>":"",v=v.replace("Sword/Mace/Dagger/Greatsword/Polearm","Melee Weapon"),i.type){case"Magical":i.type="Magical";break;case"Physical":i.type="Physical"}switch(i.sub_type){case"Buff":i.sub_type="Buff";break;case"Attack":i.sub_type="Attack";break;case"Debuff":i.sub_type="Debuff";break;case"None":i.sub_type="Skill";break;case"Heal":i.sub_type="Heal";break;case"Summon":i.sub_type="Summon";break;case"SummonTrap":i.sub_type="Summon Trap";break;case"SummonHoming":i.sub_type="Summon Homing"}if("charge"!=skill[a].type){i.action=skill[a].action,i.cost={},i.cost.value=skill[a].lvls[t].cost.value,i.cd=skill[a].cd;var _={};for(var p in skill[a].lvls[t].rules)_[p]=skill[a].lvls[t].rules[p];i.lvlup={},void 0!=skill[a].lvls[t].lv_up?(i.lvlup.type=skill[a].lvls[t].lv_up.type,i.lvlup.value=skill[a].lvls[t].lv_up.value,i.lvlup.param=skill[a].lvls[t].lv_up.param):(i.lvlup.type="0",i.lvlup.value="0",i.lvlup.param="0"),"MP"==i.lvlup.type?(i.cost.value=Number(i.cost.value)+Number(i.lvlup.value*s),i.lvlup="mp"):"cd"==i.lvlup.type?(i.cd=Number(i.cd)+Number(i.lvlup.value*s),i.lvlup="cd"):(i.lvlup_stat=i.lvlup.param instanceof Array?i.lvlup.param[0]:i.lvlup.param,i.lvlup.param instanceof Array?(_[i.lvlup.param[0]]=Number(String(_[i.lvlup.param[0]]).replace(" ",""))+Number(i.lvlup.value*s),_[i.lvlup.param[1]]=Number(String(_[i.lvlup.param[1]]).replace(" ",""))+Number(i.lvlup.value*s)):_[i.lvlup.param]=Number(String(_[i.lvlup.param]).replace(" ",""))+Number(i.lvlup.value*s),i.lvlup="stat"),i.lvlup_mp="mp"==i.lvlup&&s>1?g:"",i.lvlup_cd="cd"==i.lvlup&&s>1?g:"",i.lvlup_st="stat"==i.lvlup&&s>1?g:"",i.cd=getTime(i.cd),i.action=d[i.action],i.desc=skill[a].desc.replaceAll("\n","<br>");for(var c in _){var n=String(_[c]);""!=i.lvlup_st&&i.lvlup_stat==c&&s>0&&(isNaN(n.replace(" ",""))||(n=g+n)),i.desc=i.desc.replace(c,n)}return i.desc=i.desc.replaceAll("%%%","%"),i.desc=i.desc.replaceAll("%%","%"),"MP"==skill[a].lvls[t].cost.type?i.cost='MP <span class="highlighted">'+i.cost.value+"</span>":"none"==skill[a].lvls[t].cost?i.cost="None":("MP_Ratio"==skill[a].lvls[t].cost.type,0!=skill[a].lvls[t].cost.timer?i.cost='MP <span class="highlighted">'+i.cost.value+"</span>% ("+getTime(skill[a].lvls[t].cost.timer)+")":i.cost="MP "+i.cost.value+"%"),i.pvp_time=void 0!=skill[a].pvp_time?'<tr><td>PvP: Remain time</td><td><span class="highlighted">'+skill[a].pvp_time+"</span>%</td></tr>":"",i.pvp_dmg=void 0!=skill[a].pvp_damage?'<tr><td>PvP: Damage</td><td><span class="highlighted">'+skill[a].pvp_damage+"</span>%</td></tr>":"",i.lvlup=s>1?'<span class="enchant_num">+'+(s-1)+"</span> ":"",'<div class="name">'+i.lvlup+i.name+" <span>lvl "+(t+1)+" / "+skill[a].lvl+"</span>"+(i.lvl_status?'&nbsp;<span class="lvl">Available at ':'&nbsp;<span class="alert lvl">Available at ')+i.lvl+' level<span></div><div class="type">'+i.tag+"<span>"+i.type+" - "+i.sub_type+'</span></div><hr><div class="desc">'+i.desc.replace(/([0-9])/gim,'<span class="highlighted">$1</span>')+'</div><hr><table><tr><td width="50%">Target</td><td>'+i.action+"</td></tr><tr><td>Usage cost"+i.lvlup_mp+"</td><td>"+i.cost+"<tr><td>Cast time</td><td>"+("instance"!=skill[a].prepare?getTime(skill[a].prepare):"Cast Instantly")+"</td></tr><tr><td>Cooldown"+i.lvlup_cd+"</td><td>"+i.cd+"</td></tr>"+i.pvp_time+i.pvp_dmg+"</table>"+v+"</div>"}i.lvlup=s>1?'<span class="enchant_num">+'+(s-1)+"</span> ":"",t+=1,i.cd=skill[a].cd;var u='<div class="name">'+i.lvlup+i.name+" <span>lvl "+t+" / "+skill[a].lvl+"</span>"+(i.lvl_status?'&nbsp;<span class="lvl">Available at ':'&nbsp;<span class="alert lvl">Available at ')+i.lvl+' level<span></div><div class="type">'+i.tag+"<span>"+i.type+" - "+i.sub_type+"</span></div>",_=(void 0==skill[a].stage_3?2:3,{});_.stage_1={},i.stage_1={};for(var p in skill[a].lvls["lvl_"+t].stage_1.rules)_.stage_1[p]=skill[a].lvls["lvl_"+t].stage_1.rules[p];i.stage_1.action=skill[a].stage_1.action,i.stage_1.action=d[i.stage_1.action],i.stage_1.prepare=skill[a].stage_1.prepare,i.stage_1.cost={},i.stage_1.cost.value=skill[a].lvls["lvl_"+t].stage_1.cost.value,i.pvp_time=void 0!=skill[a].stage_1.pvp_time?'<tr><td>PvP: Remain time</td><td><span class="highlighted">'+skill[a].stage_1.pvp_time+"</span>%</td></tr>":"",i.pvp_dmg=void 0!=skill[a].stage_1.pvp_damage?'<tr><td>PvP: Damage</td><td><span class="highlighted">'+skill[a].stage_1.pvp_damage+"</span>%</td></tr>":"",i.stage_1.lvlup={},void 0!=skill[a].lvls["lvl_"+t].stage_1.lv_up?(i.stage_1.lvlup.type=skill[a].lvls["lvl_"+t].stage_1.lv_up.type,i.stage_1.lvlup.value=skill[a].lvls["lvl_"+t].stage_1.lv_up.value,i.stage_1.lvlup.param=skill[a].lvls["lvl_"+t].stage_1.lv_up.param):(i.stage_1.lvlup.type="0",i.stage_1.lvlup.value="0",i.stage_1.lvlup.param="0"),"MP"==i.stage_1.lvlup.type?(i.stage_1.cost.value=Number(i.stage_1.cost.value)+Number(i.stage_1.lvlup.value*s),i.lvlup="mp"):"cd"==i.stage_1.lvlup.type?(i.cd=Number(i.cd)+Number(i.stage_1.lvlup.value*s),i.lvlup="cd"):(i.stage_1.lvlup_stat=i.stage_1.lvlup.param instanceof Array?i.stage_1.lvlup.param[0]:i.stage_1.lvlup.param,i.stage_1.lvlup.param instanceof Array?(_.stage_1[i.stage_1.lvlup.param[0]]=Number(String(_.stage_1[i.stage_1.lvlup.param[0]]).replace(" ",""))+Number(i.stage_1.lvlup.value*s),_.stage_1[i.stage_1.lvlup.param[1]]=Number(String(_.stage_1[i.stage_1.lvlup.param[1]]).replace(" ",""))+Number(i.stage_1.lvlup.value*s)):_.rules_1[i.stage_1.lvlup.param]=Number(String(_[i.stage_1.lvlup.param]).replace(" ",""))+Number(i.stage_1.lvlup.value*s),i.lvlup="stat"),i.lvlup_mp="mp"==i.lvlup&&s>1?g:"",i.lvlup_cd="cd"==i.lvlup&&s>1?g:"",i.lvlup_st="stat"==i.lvlup&&s>1?g:"",i.cd=getTime(i.cd),"MP"==skill[a].lvls["lvl_"+t].stage_1.cost.type?i.stage_1.cost='MP <span class="highlighted">'+i.stage_1.cost.value+"</span>":"none"==skill[a].lvls["lvl_"+t].stage_1.cost?i.stage_1.cost="None":"MP_Ratio"==skill[a].lvls["lvl_"+t].stage_1.cost.type?0!=skill[a].lvls["lvl_"+t].stage_1.cost.timer?i.stage_1.cost='MP <span class="highlighted">'+i.stage_1.cost.value+"<span>% ("+getTime(skill[a].lvls["lvl_"+t].stage_1.cost.timer)+")":i.stage_1.cost="MP "+i.stage_1.cost.value+"%":"HP"==skill[a].lvls["lvl_"+t].stage_1.cost.type?i.stage_1.cost='HP <span class="highlighted">'+skill[a].lvls["lvl_"+t].stage_1.cost.value+"</span>":i.stage_1.cost="None",i.stage_1.desc="",i.stage_1.desc=skill[a].stage_1.desc.replaceAll("\n","<br>");for(var c in _.stage_1){var n=String(_.stage_1[c]);""!=i.stage_1.lvlup_st&&i.stage_1.lvlup_stat==c&&s>0&&(isNaN(n.replace(" ",""))||(n=g+n)),i.stage_1.desc=i.stage_1.desc.replace(c,n)}i.stage_1.desc=i.stage_1.desc.replaceAll("%%%","%"),i.stage_1.desc=i.stage_1.desc.replaceAll("%%","%"),u+="<hr>1 Stage<br>"+i.stage_1.desc.replace(/([0-9])/gim,'<span class="highlighted">$1</span>')+"<hr>",u+="<table><tr><td>Target</td><td>"+i.stage_1.action+"</td></tr><tr><td>Usage cost"+i.lvlup_mp+"</td><td>"+i.stage_1.cost+"<tr><td>Charging Time</td><td>"+("instance"!=skill[a].stage_1.prepare?getTime(skill[a].stage_1.prepare):"Cast Instantly")+"</td></tr>"+i.pvp_time+i.pvp_dmg+"</table>",_.stage_2={},i.stage_2={};for(var p in skill[a].lvls["lvl_"+t].stage_2.rules)_.stage_2[p]=skill[a].lvls["lvl_"+t].stage_2.rules[p];i.stage_2.action=d[skill[a].stage_2.action],i.stage_2.prepare=skill[a].stage_2.prepare,i.stage_2.cost={},i.stage_2.cost.value=skill[a].lvls["lvl_"+t].stage_2.cost.value,i.stage_2.lvlup={},void 0!=skill[a].lvls["lvl_"+t].stage_2.lv_up?(i.stage_2.lvlup.type=skill[a].lvls["lvl_"+t].stage_2.lv_up.type,i.stage_2.lvlup.value=skill[a].lvls["lvl_"+t].stage_2.lv_up.value,i.stage_2.lvlup.param=skill[a].lvls["lvl_"+t].stage_2.lv_up.param):(i.stage_2.lvlup.type="0",i.stage_2.lvlup.value="0",i.stage_2.lvlup.param="0"),i.pvp_time=void 0!=skill[a].stage_2.pvp_time?'<tr><td>PvP: Remain Time</td><td><span class="highlighted">'+skill[a].stage_2.pvp_time+"</span>%</td></tr>":"",i.pvp_dmg=void 0!=skill[a].stage_2.pvp_damage?'<tr><td>PvP: Damage</td><td><span class="highlighted">'+skill[a].stage_2.pvp_damage+"</span>%</td></tr>":"","MP"==i.stage_2.lvlup.type?(i.stage_2.cost.value=Number(i.stage_2.cost.value)+Number(i.stage_2.lvlup.value*s),i.lvlup="mp"):"cd"==i.stage_2.lvlup.type||(i.stage_2.lvlup_stat=i.stage_2.lvlup.param instanceof Array?i.stage_2.lvlup.param[0]:i.stage_2.lvlup.param,i.stage_2.lvlup.param instanceof Array?(_.stage_2[i.stage_2.lvlup.param[0]]=Number(String(_.stage_2[i.stage_2.lvlup.param[0]]).replace(" ",""))+Number(i.stage_2.lvlup.value*s),_.stage_2[i.stage_2.lvlup.param[1]]=Number(String(_.stage_2[i.stage_2.lvlup.param[1]]).replace(" ",""))+Number(i.stage_2.lvlup.value*s)):_.rules_1[i.stage_2.lvlup.param]=Number(String(_[i.stage_2.lvlup.param]).replace(" ",""))+Number(i.stage_2.lvlup.value*s),i.lvlup="stat"),i.lvlup_mp="mp"==i.lvlup&&s>1?g:"",i.lvlup_cd="cd"==i.lvlup&&s>1?g:"",i.lvlup_st="stat"==i.lvlup&&s>1?g:"","MP"==skill[a].lvls["lvl_"+t].stage_2.cost.type?i.stage_2.cost='MP <span class="highlighted">'+i.stage_2.cost.value+"</span>":"none"==skill[a].lvls["lvl_"+t].stage_2.cost?i.stage_2.cost="None":"MP_Ratio"==skill[a].lvls["lvl_"+t].stage_2.cost.type?0!=skill[a].lvls["lvl_"+t].stage_2.cost.timer?i.stage_2.cost='MP <span class="highlighted">'+i.stage_2.cost.value+"</span>% ("+getTime(skill[a].lvls["lvl_"+t].stage_2.cost.timer)+")":i.stage_2.cost="MP "+i.stage_2.cost.value+"%":"HP"==skill[a].lvls["lvl_"+t].stage_2.cost.type?i.stage_2.cost='HP <span class="highlighted">'+skill[a].lvls["lvl_"+t].stage_2.cost.value+"</span>":i.stage_2.cost="None",i.stage_2.desc="",i.stage_2.desc=skill[a].stage_2.desc.replaceAll("\n","<br>");for(var c in _.stage_2){var n=String(_.stage_2[c]);""!=i.stage_2.lvlup_st&&i.stage_2.lvlup_stat==c&&s>0&&(isNaN(n.replace(" ",""))||(n=g+n)),i.stage_2.desc=i.stage_2.desc.replace(c,n)}if(i.stage_2.desc=i.stage_2.desc.replaceAll("%%%","%"),i.stage_2.desc=i.stage_2.desc.replaceAll("%%","%"),u+="<hr>2 Stage<br>"+i.stage_2.desc.replace(/([0-9])/gim,'<span class="highlighted">$1</span>')+"<hr>",u+="<table><tr><td>Target</td><td>"+i.stage_2.action+"</td></tr><tr><td>Usage Cost"+i.lvlup_mp+"</td><td>"+i.stage_2.cost+"<tr><td>"+(void 0==skill[a].stage_3?"Hold Time":"Charging Time")+"</td><td>"+("instance"!=skill[a].stage_2.prepare?getTime(skill[a].stage_2.prepare):"Cast Instantly")+"</td></tr>"+i.pvp_time+i.pvp_dmg+"</table>",void 0!=skill[a].stage_3){_.stage_3={},i.stage_3={};for(var p in skill[a].lvls["lvl_"+t].stage_3.rules)_.stage_3[p]=skill[a].lvls["lvl_"+t].stage_3.rules[p];i.stage_3.action=d[skill[a].stage_3.action],i.stage_3.prepare=skill[a].stage_3.prepare,i.stage_3.cost={},i.stage_3.cost.value=skill[a].lvls["lvl_"+t].stage_3.cost.value,i.pvp_time=void 0!=skill[a].stage_3.pvp_time?'<tr><td>PvP: Remain Time</td><td><span class="highlighted">'+skill[a].stage_3.pvp_time+"</span>%</td></tr>":"",i.pvp_dmg=void 0!=skill[a].stage_3.pvp_damage?'<tr><td>PvP: Damage</td><td><span class="highlighted">'+skill[a].stage_3.pvp_damage+"</span>%</td></tr>":"",i.stage_3.lvlup={},void 0!=skill[a].lvls["lvl_"+t].stage_3.lv_up?(i.stage_3.lvlup.type=skill[a].lvls["lvl_"+t].stage_3.lv_up.type,i.stage_3.lvlup.value=skill[a].lvls["lvl_"+t].stage_3.lv_up.value,i.stage_3.lvlup.param=skill[a].lvls["lvl_"+t].stage_3.lv_up.param):(i.stage_3.lvlup.type="0",i.stage_3.lvlup.value="0",i.stage_3.lvlup.param="0"),"MP"==i.stage_3.lvlup.type?(i.stage_3.cost.value=Number(i.stage_3.cost.value)+Number(i.stage_3.lvlup.value*s),i.lvlup="mp"):"cd"==i.stage_3.lvlup.type||(i.stage_3.lvlup_stat=i.stage_3.lvlup.param instanceof Array?i.stage_3.lvlup.param[0]:i.stage_3.lvlup.param,i.stage_3.lvlup.param instanceof Array?(_.stage_3[i.stage_3.lvlup.param[0]]=Number(String(_.stage_3[i.stage_3.lvlup.param[0]]).replace(" ",""))+Number(i.stage_3.lvlup.value*s),_.stage_3[i.stage_3.lvlup.param[1]]=Number(String(_.stage_3[i.stage_3.lvlup.param[1]]).replace(" ",""))+Number(i.stage_3.lvlup.value*s)):_.rules_1[i.stage_3.lvlup.param]=Number(String(_[i.stage_3.lvlup.param]).replace(" ",""))+Number(i.stage_3.lvlup.value*s),i.lvlup="stat"),i.lvlup_mp="mp"==i.lvlup&&s>1?g:"",i.lvlup_cd="cd"==i.lvlup&&s>1?g:"",i.lvlup_st="stat"==i.lvlup&&s>1?g:"","MP"==skill[a].lvls["lvl_"+t].stage_3.cost.type?i.stage_3.cost='MP <span class="highlighted">'+i.stage_3.cost.value+"</span>":"none"==skill[a].lvls["lvl_"+t].stage_3.cost?i.stage_3.cost="None":"MP_Ratio"==skill[a].lvls["lvl_"+t].stage_3.cost.type?0!=skill[a].lvls["lvl_"+t].stage_3.cost.timer?i.stage_3.cost='MP <span class="highlighted">'+i.stage_3.cost.value+"</span>% ("+getTime(skill[a].lvls["lvl_"+t].stage_3.cost.timer)+")":i.stage_3.cost="MP "+i.stage_3.cost.value+"%":"HP"==skill[a].lvls["lvl_"+t].stage_3.cost.type?i.stage_3.cost='HP <span class="highlighted">'+skill[a].lvls["lvl_"+t].stage_3.cost.value+"</span>":i.stage_3.cost="None",i.stage_3.desc="",i.stage_3.desc=skill[a].stage_3.desc.replaceAll("\n","<br>");for(var c in _.stage_3){var n=String(_.stage_3[c]);""!=i.stage_3.lvlup_st&&i.stage_3.lvlup_stat==c&&s>0&&(isNaN(n.replace(" ",""))||(n=g+n)),i.stage_3.desc=i.stage_3.desc.replace(c,n)}i.stage_3.desc=i.stage_3.desc.replaceAll("%%%","%"),i.stage_3.desc=i.stage_3.desc.replaceAll("%%","%"),u+="<hr>3 Stage<br>"+i.stage_3.desc.replace(/([0-9])/gim,'<span class="highlighted">$1</span>')+"<hr>",u+="<table><tr><td>Target</td><td>"+i.stage_3.action+"</td></tr><tr><td>Usage Cost"+i.lvlup_mp+"</td><td>"+i.stage_3.cost+"<tr><td>Hold Time</td><td>"+("instance"!=skill[a].stage_3.prepare?getTime(skill[a].stage_3.prepare):"Cast Instantly")+"</td></tr>"+i.pvp_time+i.pvp_dmg+"</table>"}return u+="<hr><table><tr><td>Cooldown"+i.lvlup_cd+"</td><td>"+i.cd+"</td></tr></table>"+v+"</div>"},getTime=function(a){var l=a/1e3/3600^0,s=(a/1e3-3600*l)/60^0,t=a/1e3-3600*l-60*s,e=6e4>a?'<span class="highlighted">'+(a/1e3).toFixed(1).replace(".0","")+"</span> sec":'<span class="highlighted">'+s+'</span> min <span class="highlighted">'+t.toFixed(1).replace(".0","")+"</span> sec";return e.replace(' <span class="highlighted">0</span> sec',"")};